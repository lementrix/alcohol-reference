---
import "../styles/main.css";

const BASE = import.meta.env.BASE_URL;
---

<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Alcohol Reference</title>
  </head>
  <body>
    <h1>Alcohol Reference</h1>

    <input
      id="search"
      type="text"
      placeholder="Szukaj produktu..."
      autocomplete="off"
    />

    <ul id="results"></ul>

    <script>
      const BASE = import.meta.env.BASE_URL;

      const input = document.getElementById("search");
      const results = document.getElementById("results");

      let products = [];

      fetch(`${BASE}data/products.json`)
        .then(res => res.json())
        .then(data => {
          products = data;
          render([]);
        });

      function render(list) {
        results.innerHTML = "";

        if (list.length === 0) return;

        list.forEach(p => {
          const li = document.createElement("li");
          const a = document.createElement("a");
          a.href = `${BASE}products/${p.slug}/`;
          a.textContent = p.name;
          li.appendChild(a);
          results.appendChild(li);
        });
      }

      input.addEventListener("input", e => {
        const q = e.target.value.trim().toLowerCase();

        if (q === "") {
          render([]);
          return;
        }

        const filtered = products.filter(p =>
          p.name.toLowerCase().includes(q)
        );

        render(filtered);
      });
    </script>
  </body>
</html>