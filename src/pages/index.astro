---
import products from "../data/products";
import "../styles/main.css";
---

<!DOCTYPE html>
<html lang="pl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Alcohol Reference</title>
  </head>

  <body>
    <h1>Alcohol Reference</h1>

    <!-- SEARCH -->
    <div class="search">
      <input
        type="text"
        id="search"
        placeholder="Szukaj produktu..."
        autocomplete="off"
      />

      <div class="results" id="results"></div>
    </div>

    <!-- FALLBACK LIST -->
    <ul id="list">
      {products.map(product => (
        <li>
          <a href={`/products/${product.slug}/`}>
            {product.name}
          </a>
        </li>
      ))}
    </ul>

    <script>
      const input = document.getElementById("search");
      const results = document.getElementById("results");

      input.addEventListener("input", () => {
        const q = input.value.toLowerCase().trim();
        results.innerHTML = "";

        if (!q) return;

        const matches = {JSON.stringify(products)}.filter(p =>
          p.name.toLowerCase().includes(q)
        );

        matches.forEach(p => {
          const a = document.createElement("a");
          a.href = `/products/${p.slug}/`;
          a.className = "result-item";
          a.innerHTML = `
            <strong>${p.name}</strong>
            <span class="subtitle">${p.subtitle ?? ""}</span>
          `;
          results.appendChild(a);
        });
      });
    </script>
  </body>
</html>